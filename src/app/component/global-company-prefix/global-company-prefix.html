<div class=" card container-fluid text-center" style="background-color: aliceblue;">
    <h3 class="mb-3 Heading-font-family pt-1">GLOBAL COMPANY PREFIX</h3>
</div>
<div class="container-fluid p-0 m-0 py-3">
    <div class="row justify-content-center g-4 px-3">
                  <div *ngIf="loadingSectionA; else sectionAContentA" class="spinner-container">
                    <mat-spinner diameter="40"></mat-spinner>
                  </div>
                  <ng-template #sectionAContentA>
        <div class="col-lg-12 mb-5">
             <!-- DATA Table -->
             <div class="row justify-content-center g-4 p-3">
                <!-- Card 1 -->
                <div class="col-12 col-md-12 p-2">
                  <div class="" style="padding-bottom: 20px;">
                    <div class=" card row shadow ">
                      <div class="d-flex justify-content-between align-items-center m-2">
                        <div class="filter-field flex-grow-1">
                          <input type="text" class="form-control" placeholder="Search" (keyup)="applyTextFilter($event)">
                        </div>
                
                        <!-- <button type="button" class="btn border rounded mr-1 text-light" style="background-color: rgb(21, 184, 0);"
                          (click)="onButtonClickAT()"><i class="bi bi-folder-plus"></i></button> -->
                        <div class="export-menu-container m-2">
                          <button type="button" class="btn border rounded mr-1 text-light" 
                          style="background-color: rgb(21, 184, 0);" (click)="onButtonClick1()">Add <i
                              class="bi bi-folder-plus"></i></button>
                          <!-- <button type="button" class="btn border rounded btn-outline-secondary" mat-button
                            [matMenuTriggerFor]="exportMenu">Export</button>
                          <mat-menu #exportMenu="matMenu">
                            <button mat-menu-item
                              (click)="exporter.exportTable('xlsx', { fileName: 'COMPLIANCED', sheet: 'COMPLIANCED', Props: { Author: 'cgmsc' }})">Excel</button>
                            <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
                            <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
                             <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
                            <button mat-menu-item (click)="exportToPDF()">PDF</button>
                          </mat-menu> -->
                        </div>
                      </div>
                      <div class="table-responsive">
                        <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
                          [dataSource]="dataSource" #exporter="matTableExporter" matSort #sort="matSort">
                
                          <ng-container matColumnDef="sno">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
                            <td mat-cell *matCellDef="let element" class="text-center">
                              {{element.sno}} </td>
                          </ng-container>
                          <ng-container matColumnDef="gcpid">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> GCP Id</th>
                            <td mat-cell *matCellDef="let element" class="text-center"> {{element.gcpid}} </td>
                          </ng-container>
                          <ng-container matColumnDef="vregid">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>VRE Id</th>
                            <td mat-cell *matCellDef="let element" class="text-center"> {{element.vregid}} </td>
                          </ng-container>
                          <ng-container matColumnDef="gcpno">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>GCP No</th>
                            <td mat-cell *matCellDef="let element" class="text-center"> {{element.gcpno}} </td>
                          </ng-container>
                          
                          <ng-container matColumnDef="issuedate">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Issue Date</th>
                            <td mat-cell *matCellDef="let element" class="text-center"> {{element.issuedate}} </td>
                          </ng-container>
                          <ng-container matColumnDef="startdate">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Date</th>
                            <td mat-cell *matCellDef="let element" class="text-center"> {{element.startdate}} </td>
                          </ng-container>
                          <ng-container matColumnDef="expdate">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Validity Date</th>
                            <td mat-cell *matCellDef="let element" class="text-center"> {{element.expdate}} </td>
                          </ng-container>
                          <ng-container matColumnDef="entrydate">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Entry Date</th>
                            <td mat-cell *matCellDef="let element" class="text-center"> {{element.entrydate}} </td>
                          </ng-container>
                          <ng-container matColumnDef="filename">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>View Certificate</th>
                            <td mat-cell *matCellDef="let element" class="text-center">
                              <button
                                class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle bg-danger-subtle"
                                mat-button
                                (click)="DownloadFileWithName(element.filepath,element.filename)"
                              ><i
                                  class="bi bi-filetype-pdf text-danger"></i>
                                <!-- <i class="bi bi-folder2-open me-0 gradient-heading"></i> -->
                              </button>
                            </td>
                          </ng-container>
                
                          <ng-container matColumnDef="action">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>Edit</th>
                            <td mat-cell *matCellDef="let element" class="text-center">
                              <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                <button
                                  class="btn btn-sm text-light align-items-center border rounded btn-outline-info-subtle  bg-info-subtle"
                                  mat-button (click)="onButtonClick(element.vregid)">
                                  <i class="bi bi-pencil-square text-primary"></i>
                                </button>
                              <!-- </span> -->
                            </td>
                          </ng-container>
                          <ng-container matColumnDef="delete">
                            <th mat-header-cell *matHeaderCellDef>Delete</th>
                            <td mat-cell *matCellDef="let element" class="text-center">
                              <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                <button
                                  class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle  bg-danger-subtle"
                                  mat-button (click)="onButtonClick(element.atid)">
                                  <i class="bi bi-trash text-danger"></i>
                                </button>
                              <!-- </span> -->
                            </td>
                          </ng-container>
                          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>
                        <mat-paginator #paginator [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
                      </div>
                    </div>
                  </div>
                </div>
            </div>
            <!-- END DATA TABLE -->
            <div class="card shadow-lg p-4 border-0 bg-white rounded " *ngIf="onshow == true">
                <div class="card-body border rounded px-0 pt-2 pb-3 bg-light"
                    style="height: auto; overflow: hidden; position: relative;">
                    <div class="mb-3 Fon-family" style="text-align: justify;">
                        <form class="p-2"  #GCPForm="ngForm" (ngSubmit)="InsertGCP(GCPForm)">
                            <div class="row pb-3">
                                <div class="form-group col-md-6  pt-3">
                                    <label for="inputPassword4">Global Company Prefix No: <span
                                            class="text-danger">*</span></label>
                                    <input type="text" class="form-control" placeholder="Type your GCP No"
                                    id="mGCpNo"
                                    name="mGCpNo"
                                    [(ngModel)]="mGCpNo" #mGCpNoee="ngModel"
                                    required
                                    [ngClass]="{
                                      'is-invalid': (mGCpNoee.touched || GCPForm.submitted) && mGCpNoee.invalid,
                                      'is-valid': mGCpNoee.valid && (mGCpNoee.touched || GCPForm.submitted)
                                    }" />
                                      <div class="text-danger mt-1"
                                      *ngIf="(mGCpNoee.touched || GCPForm.submitted) && mGCpNoee.errors?.['required']">
                                      Global Company Prefix No is required.
                                    </div>
                                </div>
                                <div class="form-group col-md-6 pt-3">
                                    <label for="inputEmail4">Issue Date.: <span class="text-danger">*</span></label>
                                    <input  type="date" class="form-control" placeholder="Type your Issue Date"
                                    id="ISSUEDATE"
                                    name="ISSUEDATE"
                                    [(ngModel)]="ISSUEDATE"
                                    #ISSUEDATEee="ngModel"  required (change)="validateDates()" [max]="today" 
                                        [ngClass]="{
                                          'is-invalid': (ISSUEDATEee.touched || GCPForm.submitted) && ISSUEDATEee.invalid,
                                          'is-valid': ISSUEDATEee.valid && (ISSUEDATEee.touched || GCPForm.submitted)
                                        }" />
                                           <div class="text-danger mt-1"
                                           *ngIf="(ISSUEDATEee.touched || GCPForm.submitted) && ISSUEDATEee.errors?.['required']">
                                           Issue Date is required.
                                      </div>
                                </div>
                            </div>

                            <div class="row pb-3">
                                <div class="form-group col-md-6 pt-3">
                                    <label for="inputAddress">Start Date: <span class="text-danger">*</span></label>
                                    <input  type="date" class="form-control" placeholder="Type your Start Date"
                                    id="mstartdate"
                                    name="mstartdate"
                                    [(ngModel)]="mstartdate"
                                    #mstartdatee="ngModel"  required (change)="validateDates()" [max]="today" 
                                    [ngClass]="{
                                      'is-invalid': 
                                         (mEXPDateee.touched || GCPForm.submitted) && (mEXPDateee.invalid || starterrorMsg),
                              
                                      'is-valid': 
                                      mEXPDateee.valid && (mEXPDateee.touched || GCPForm.submitted) && !starterrorMsg
                                   }">
                                          <div class="text-danger mt-1"
                                          *ngIf="(mstartdatee.touched || GCPForm.submitted) && mstartdatee.errors?.['required']">
                                       Start Date is required.
                                     </div>
                                     <div class="text-danger mt-1">
                                      <p class="text-danger">{{ starterrorMsg }}</p>
                                    </div>
                                </div>
                                <div class="form-group col-md-6 pt-3">
                                    <label for="inputAddress">Validity Date: <span class="text-danger">*</span></label>
                                    <input  type="date" class="form-control" placeholder="Type your Validity Date"
                                    id="mEXPDate"
                                    name="mEXPDate"(change)="validateDates()"
                                    [(ngModel)]="mEXPDate"
                                    #mEXPDateee="ngModel"  required 
                                    [ngClass]="{
                                      'is-invalid': 
                                         (mEXPDateee.touched || GCPForm.submitted) && (mEXPDateee.invalid || validityerrorMsg),
                              
                                      'is-valid': 
                                      mEXPDateee.valid && (mEXPDateee.touched || GCPForm.submitted) && !validityerrorMsg
                                   }"  />
                                       <div class="text-danger mt-1"
                                       *ngIf="(mEXPDateee.touched || GCPForm.submitted) && mEXPDateee.errors?.['required']">
                                       Validity Date is required.
                                  </div>
                                  <div class="text-danger mt-1">
                                  <p class="text-danger">{{ validityerrorMsg }}</p>
                                  </div>
                                </div>
                                
                                </div>

                            <!-- </div> -->

                            <div class="row pb-3">
                                <div class="form-group col-md-12 pt-3">
                                    <label for="inputnumber">Upload GCP Certificate: <span
                                            class="text-danger">*</span></label>
                                    <input type="file" class="form-control"   id="fileInput" accept=".pdf"
                                    (change)="onFileSelected($event)" name="files" 
                                    required
                                        #files="ngModel"
                                        ngModel
                                        [ngClass]="{
                                          'is-invalid': (files.touched || GCPForm.submitted) && files.invalid,
                                          'is-valid': files.valid && (files.touched || GCPForm.submitted)
                                        }">
                                        <div class="text-danger mt-1"
                                        *ngIf="(files.touched || GCPForm.submitted) && files.errors?.['required']">
                                     File upload is required.
                                   </div>
                                </div>
                            </div>
                            <div class="d-flex justify-content-center mt-3">
                                <button type="submit" class="btn btn-primary" [disabled]="GCPForm.invalid">Submit</button>
                                <!-- <button type="submit" class="btn btn-primary mt-3" [disabled]="!AnnualTurnoverForm.valid">Submit</button> -->

                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
      </ng-template>
    </div>
</div>


<!-- Modal -->
<div class="modal fade custom-transparent-modal" id="pdfModal" tabindex="-1" aria-labelledby="pdfModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-fullscreen">
      <div class="modal-content border-0 shadow-none">
        <div class="modal-header bg-dark text-white py-2 px-3">
          <h5 class="modal-title" id="pdfModalLabel">PDF Preview</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-0">
          <iframe
            [src]="sanitizedPdfUrl"
            class="pdf-frame"
            allowfullscreen
          ></iframe>
        </div>
      </div>
    </div>
  </div>