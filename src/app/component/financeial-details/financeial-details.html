
<div class=" card container-fluid text-center" style="background-color: aliceblue;">
  <h3 class="mb-3 Heading-font-family pt-1">FINANCIAL DETAILS</h3>
</div>

<div class="card">
    <mat-tab-group (selectedTabChange)="selectedTabValue($event)">
      <!--  FINANCIAL DETAILS Tab -->
      <mat-tab label="BANK DETAILS">
        <ng-template matTabContent>
          <div class="container-fluid p-3 m-0 ">
            <div class="row justify-content-center g-4 ">
              <div class="col-lg-12 mb-5">
                <div *ngIf="loadingSectionA; else sectionAContent" class="spinner-container">
                  <mat-spinner diameter="40"></mat-spinner>
                </div>
                <ng-template #sectionAContent>
                <div class="row justify-content-center g-4 p-3">
                  <!-- Card 1 -->
                  <div class="col-12 col-md-12 p-2">
                    <div class="" style="padding-bottom: 20px;">
                      <div class=" card row shadow ">
                        <div class="d-flex justify-content-between align-items-center m-2">
                          <div class="filter-field flex-grow-1">
                            <input type="text" class="form-control" placeholder="Search" (keyup)="applyTextFilter1($event)">
                          </div>
                      
                           <div class="export-menu-container m-2">
                            <button type="button" class="btn border rounded text-light" mat-button
                            style="background-color: rgb(21, 184, 0);" (click)="onshowButtonClick(0)">Add <i
                              class="bi bi-folder-plus"></i></button>
                             <!--<button type="button" class="btn border rounded btn-outline-secondary" mat-button
                              [matMenuTriggerFor]="exportMenu">Export</button>
                            <mat-menu #exportMenu="matMenu">
                              <button mat-menu-item
                                (click)="exporter.exportTable('xlsx', { fileName: 'BankMandateDetail', sheet: 'BankMandateDetail', Props: { Author: 'cgmsc' }})">Excel</button>
                              <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
                              <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
                                          <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
                              <button mat-menu-item (click)="exportToPDF1()">PDF</button>
                            </mat-menu> -->
                          </div>
                        </div>
      
      
                        <div class="table-responsive">
                          <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
                            [dataSource]="dataSource1" #exporter="matTableExporter" matSort #sort1="matSort">
      
                            <ng-container matColumnDef="sno">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
                              <td mat-cell *matCellDef="let element" class="text-center"> {{element.sno}} </td>
                            </ng-container>
                            <ng-container matColumnDef="accountname">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Name In Account</th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                {{element.accountname}} </td>
                            </ng-container>
      
                            <ng-container matColumnDef="accountno">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Account No</th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                {{element.accountno}} </td>
                            </ng-container>
                            <ng-container matColumnDef="bankname">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Bank Name</th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                {{element.bankname}} </td>
                            </ng-container>
                            <ng-container matColumnDef="branch">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Branch </th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                {{element.branch}} </td>
                            </ng-container>
                            <ng-container matColumnDef="ifsccode">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>IFSC Code </th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                {{element.ifsccode}} </td>
                            </ng-container>
                            <ng-container matColumnDef="defaultacc">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Default AC</th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                {{element.defaultacc}} </td>
                            </ng-container>
                            <ng-container matColumnDef="filename" >
                              <!-- <th mat-header-cell *matHeaderCellDef mat-sort-header>Download Certificate</th> -->
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>View Certificate</th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                <button
                                class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle bg-danger-subtle"
                                mat-button 
                                (click)="DownloadFileWithName(element.filepath,element.filename)"><i class="bi bi-filetype-pdf text-danger" ></i>
                            </button>
                            </td>
                            </ng-container>
                            <ng-container matColumnDef="action">
                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Edit</th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                  <button
                                    class="btn btn-sm text-light align-items-center border rounded  btn-outline-info-subtle  bg-info-subtle"
                                    mat-button (click)="onButtonClick(element.atid)">
                                    <i class="bi bi-pencil-square text-primary"></i>
                                    <!-- <i class="bi bi-folder2-open me-0 gradient-heading"></i>style="background-color: rgb(124, 24, 255);" -->
                                  </button>
                                <!-- </span> -->
                              </td>
                            </ng-container>
                          
                            <ng-container matColumnDef="delete">
                              <th mat-header-cell *matHeaderCellDef>Delete</th>
                              <td mat-cell *matCellDef="let element" class="text-center">
                                <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                  <button
                                    class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle  bg-danger-subtle"
                                    mat-button (click)="onButtonClick(element.atid)">
                                    <i class="bi bi-trash text-danger"></i>
                                  </button>
                                <!-- </span> -->
                              </td>
                            </ng-container>
                    
      
                            <tr mat-header-row *matHeaderRowDef="displayedColumns1"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns1;"></tr>
                          </table>
                          <mat-paginator #paginator1 [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- END DATA TABLE -->
                <div class="card shadow-lg p-4 border-0 bg-white rounded " *ngIf="onshowFINANCIAL == true">
                  <div class="card-body border rounded px-0 pt-2 pb-3 bg-light"
                    style="height: auto; overflow: hidden; position: relative;">
                    <div class="mb-3 Fon-family" style="text-align: justify;">
                      <form class="p-2" #bankForm="ngForm" (ngSubmit)="onSubmit(bankForm)">
                        <div class="row pb-3">
                          <div class="form-group col-md-6 pt-3" style="position: relative;">
                           
                            <label for="inputName">Select Bank Account <span class="text-danger">*</span></label>
                            <ng-select  appendTo=".form-group" class="form-control" [items]="VendorBankDetail" bindLabel="acno" bindValue="bankaccountid" 
                              [(ngModel)]="acnoo" name="acno" (change)="onselectacno($event)"
                              [placeholder]="!acnoo ? 'Select Bank Account :' : ''"
                            
                              [searchable]="true" [clearable]="true"  #acno="ngModel"
                               required [ngStyle]="{
                                                'border': acno.invalid && (acno.dirty || acno.touched) ? '1px solid #dc3545' :
                                                acno.valid && (acno.dirty || acno.touched) ? '1px solid #198754' : '',
                                                'box-shadow': acno.invalid && (acno.dirty || accountno.touched) ? '0 0 0 0.1rem rgba(220,53,69,0.25)' :
                                                acno.valid && (acno.dirty || acno.touched) ? '0 0 0 0.1rem rgba(25,135,84,0.25)' : ''
                                              }" >
                            </ng-select>
                            
                            <div class="text-danger mt-1"
                              *ngIf="(acno.touched || bankForm.submitted) && acno.errors?.['required']">
                              Year selection is required.
                            </div>
                          </div>
                          <!-- <div class="form-group col-md-6 pt-3">
                                   [placeholder]="!acno && !dropdownOpen ? 'Select Bank Account' : ''"
                            <label for="inputName">Select Bank Account <span class="text-danger">*</span></label>
                            <ng-select class="form-control" [items]="VendorBankDetail" bindLabel="acno" bindValue="bankaccountid"
                              [(ngModel)]="acno" name="acno" (change)="onselectacno($event)"
                              [placeholder]="'Select Bank Account: '" [searchable]="true" [clearable]="true"  #acno="ngModel"
                              appendTo="body" required [ngStyle]="{
                                                'border': acno.invalid && (acno.dirty || acno.touched) ? '1px solid #dc3545' :
                                                acno.valid && (acno.dirty || acno.touched) ? '1px solid #198754' : '',
                                                'box-shadow': acno.invalid && (acno.dirty || accountno.touched) ? '0 0 0 0.1rem rgba(220,53,69,0.25)' :
                                                acno.valid && (acno.dirty || acno.touched) ? '0 0 0 0.1rem rgba(25,135,84,0.25)' : ''
                                              }">
                            </ng-select>

                            <div class="text-danger mt-1"
                              *ngIf="(acno.touched || bankForm.submitted) && acno.errors?.['required']">
                              Year selection is required.
                            </div>
                          </div> -->
                          <div class="form-group col-md-6  pt-3">
                            <label for="inputPassword4">Name In Account: <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" [(ngModel)]="SupplierBankAccDetail.accountname"
                              [disabled]="!isNewBank" [ngModelOptions]="{standalone: true}" placeholder="Type your Name In Account"
                              id="inputPassword4" #accountname="ngModel" required [ngClass]="{
                                                                                      'is-invalid': (accountname.touched || bankForm.submitted) && accountname.invalid,
                                                                                      'is-valid': accountname.valid && (accountname.touched || bankForm.submitted)
                                                                                    }" />
                            <div class="text-danger mt-1"
                              *ngIf="(accountname.touched || bankForm.submitted) && accountname.errors?.['required']">
                              Account name is required.
                            </div>
                          </div>
                        </div>
                
                        <div class="row pb-3">
                          <div class="form-group col-md-6 pt-3">
                            <label for="inputEmail4">Bank Name: <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" placeholder="Bank Name:*"
                              [(ngModel)]="SupplierBankAccDetail.bankname" [disabled]="!isNewBank" [ngModelOptions]="{standalone: true}"
                              id="inputEmail4" #bankname="ngModel" required [ngClass]="{
                              'is-invalid': (bankname.touched || bankForm.submitted) && bankname.invalid,
                               'is-valid': bankname.valid && (bankname.touched || bankForm.submitted)
                                 }" />
                            <div class="text-danger mt-1"
                              *ngIf="(bankname.touched || bankForm.submitted) && bankname.errors?.['required']">
                              Bank name is required.
                            </div>
                          </div>
                          <div class="form-group col-md-6 pt-3">
                            <label for="inputAddress">IFSC Code: <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" (keyup)="onIFSCChange()" [disabled]="!isNewBank" [ngModelOptions]="{standalone: true}"
                              [(ngModel)]="SupplierBankAccDetail.ifsccode" placeholder="Type your IFSC Code" id="inputAddress"
                              pattern="^[A-Z]{4}0[A-Z0-9]{6}$" #ifsccode="ngModel" required  [ngClass]="{
                                'is-invalid': 
                                   (ifsccode.touched || bankForm.submitted) &&
                                   (ifsccode.invalid || statusText),
                        
                                'is-valid': 
                                   ifsccode.valid && 
                                   (ifsccode.touched || bankForm.submitted) &&
                                   !statusText
                             }" />
                            <div class="text-danger mt-1"
                              *ngIf="(ifsccode.touched || bankForm.submitted) && ifsccode.errors?.['required']">
                              IFSC code is required.
                            </div>
                            <div class="text-danger mt-1" *ngIf="ifsccode.errors?.['pattern']">
                              Enter a valid IFSC code (e.g. SBUN0001234).
                            </div>
                            <div class="text-danger mt-1" *ngIf="onshowPP==false"  >
                              {{statusText}}
                            </div>
                
                          </div>
                        </div>
                
                        <div class="row pb-3">
                          <div class="form-group col-md-6 pt-3">
                            <label for="inputnumber">Account No: <span class="text-danger">*</span></label>
                            <input type="number" class="form-control" [disabled]="!isNewBank" [ngModelOptions]="{standalone: true}"
                              [(ngModel)]="SupplierBankAccDetail.accountno" placeholder="Type your Account No" id="inputnumber"
                              minlength="9" maxlength="18" #accountno="ngModel" required [ngClass]="{
                                                                                    'is-invalid': (accountno.touched || bankForm.submitted) && accountno.invalid,
                                                                                    'is-valid': accountno.valid && (accountno.touched || bankForm.submitted)
                                                                                  }" />
                            <div class="text-danger mt-1"
                              *ngIf="(accountno.touched || bankForm.submitted) && accountno.errors?.['required']">
                              Account number is required.
                            </div>
                            <div class="text-danger mt-1" *ngIf="accountno.errors?.['minlength'] || accountno.errors?.['maxlength']">
                              Account number must be between 9 and 18 digits.
                            </div>
                
                          </div>
                          <div class="form-group col-md-6 pt-3">
                            <label for="inputAddress">Branch Address: <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" [disabled]="!isNewBank" [ngModelOptions]="{standalone: true}"
                              [(ngModel)]="SupplierBankAccDetail.branch" placeholder="Type your Branch Address" id="inputAddress"
                              #branch="ngModel" required [ngClass]="{
                                                                                    'is-invalid': (branch.touched || bankForm.submitted) && branch.invalid,
                                                                                    'is-valid': branch.valid && (branch.touched || bankForm.submitted)
                                                                                  }" />
                            <div class="text-danger mt-1" *ngIf="(branch.touched || bankForm.submitted) && branch.errors?.['required']">
                              Branch address is required.
                            </div>
                
                          </div>
                        </div>
                
                        <!-- <label for="inputnumber">Upload Document </label> -->
                        <div class="row pb-3">
                          <div class="form-group col-md-6 pt-3">
                            <label for="inputnumber"> Upload Bank Mandate: <span class="text-danger">*</span></label>
                            <input type="file"  accept=".pdf" class="form-control" [disabled]="!isNewBank" (change)="onFileSelected($event)"
                              name="bankmandatefile" placeholder="Type your Account No" id="files" required #selectedFile="ngModel"
                              ngModel [ngClass]="{
                                                 'is-invalid': selectedFile.invalid && selectedFile.touched,
                                                 'is-valid': selectedFile.valid && selectedFile.touched
                                               }">
                            <!-- Validation Message -->
                            <div *ngIf="selectedFile.invalid && selectedFile.touched">
                              <small class="text-danger">
                                Please upload the Upload Bank Mandate Certificate (PDF).
                              </small>
                            </div>
                
                          </div>
                          <div class="form-group col-md-6 pt-3">
                            <!-- <button type="button" class="btn btn-primary m-3">Upload</button> 
                             <button type="submit" class="btn btn-primary m-3">Download Bank Mandate</button> -->
                             <!-- <div class="d-flex flex-wrap align-items-center justify-content-between mt-4 p-3 rounded shadow-sm bg-light border"  > -->
  
                              <!-- ðŸ“ Instruction Box -->
                              <div class="alert alert-warning mb-2 mb-md-0 flex-grow-1 me-md-3 p-3 small"
                              *ngIf="isCheckingIFSC == true">
                           <b>Bank Details:-BANK:</b>{{ifsccodeDetails.BANK}},
                           <b>Branch:</b>{{ifsccodeDetails.BRANCH}},
                           <b>BranchCode:</b>{{ifsccodeDetails.BANKCODE}},
                           <b>IFSCCode:</b>{{ifsccodeDetails.IFSC}}
                           <b>Address:</b>{{ifsccodeDetails.ADDRESS}},
                           {{ifsccodeDetails.CITY}},
                           {{ifsccodeDetails.DISTRICT}},
                           {{ifsccodeDetails.STATE}},
                           <b>MICRCode:</b>{{ifsccodeDetails.MICR}}
                         </div>
                         
                              <!-- <div class="alert alert-warning mb-2 mb-md-0 flex-grow-1 me-md-3 p-3 small" style="max-width: 650px;" *ngIf="isCheckingIFSC==true">
                                <b>Bank Details:- BANK:</b>{{ifsccodeDetails.BANK}},<b>Branch:</b>{{ifsccodeDetails.BRANCH}},<b>BranchCode:</b>{{ifsccodeDetails.BANKCODE}},<b>IFSCCode:</b>{{ifsccodeDetails.IFSC}}
                                 <b>Address:</b>{{ifsccodeDetails.ADDRESS}},{{ifsccodeDetails.CITY}},{{ifsccodeDetails.DISTRICT}},{{ifsccodeDetails.STATE}},<b>MICRCode:</b>{{ifsccodeDetails.MICR}} 
                                <span class="fw-bold text-warning">Yellow</span> or 
                                <span class="fw-bold text-danger">Pink</span> on the Product Permission Document. 
                               
                              </div> -->
                            
                              <!-- âœ… Save Button -->
                              <!-- <div class="text-end">
                                <button type="button" class="btn btn-success fw-semibold shadow-sm px-4 py-2" (click)="saveAndUpdate()">
                                  ðŸ’¾ Save & Update
                                </button>
                              </div> -->
                            <!-- </div> -->
                          </div>
                        </div>
                        <div class="d-flex justify-content-center mt-3">
                          <!-- <button type="submit" class="btn btn-primary" >Submit</button> [disabled]="FeedbackForm.invalid"-->
                          <button type="submit" class="btn btn-primary"  [disabled]="!bankForm.valid">Save</button>
                        </div>
                      </form>
                    </div>
                  </div>
               
                </div>
              </ng-template>
              </div>
            </div>
          </div>
        </ng-template>
      </mat-tab>

      <!--  ANNUAL TURNOVER CERTIFICATE Tab -->
      <mat-tab label=" ANNUAL TURNOVER CERTIFICATE " >
        <ng-template matTabContent>
            <div class="container-fluid p-3 m-0 ">
                <div class="row justify-content-center g-4 ">
                  <div *ngIf="loadingSectionB; else sectionAContentB" class="spinner-container">
                    <mat-spinner diameter="40"></mat-spinner>
                  </div>
                  <ng-template #sectionAContentB>
                    <div class="col-lg-12 mb-5">
                        <!-- DATA Table -->
                        <div class="row justify-content-center g-4 p-3">
                            <!-- Card 1 -->
                            <div class="col-12 col-md-12 p-2">
                              <div class="" style="padding-bottom: 20px;">
                                <div class=" card row shadow ">
                                  <div class="d-flex justify-content-between align-items-center m-2">
                                    <div class="filter-field flex-grow-1">
                                      <input type="text" class="form-control" placeholder="Search" (keyup)="applyTextFilter($event)">
                                    </div>
                            
                                    
                                    <div class="export-menu-container m-2">
                                      <button type="button" class="btn border rounded text-light" mat-button style="background-color: rgb(21, 184, 0);"
                                      (click)="onButtonClickAT()">Add <i class="bi bi-folder-plus"></i></button>
                                      <!-- <button type="button" class="btn border rounded btn-outline-secondary" mat-button
                                        [matMenuTriggerFor]="exportMenu">Export</button>
                                      <mat-menu #exportMenu="matMenu">
                                        <button mat-menu-item
                                          (click)="exporter.exportTable('xlsx', { fileName: 'ANNUALTURNOVER', sheet: 'ANNUALTURNOVER', Props: { Author: 'cgmsc' }})">Excel</button>
                                        <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
                                        <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
                                                                                   <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
                                        <button mat-menu-item (click)="exportToPDF()">PDF</button>
                                      </mat-menu> -->
                                    </div>
                                  </div>
                                  <div class="table-responsive">
                                    <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
                                      [dataSource]="dataSource" #exporter="matTableExporter" matSort #sort="matSort">
                            
                                      <ng-container matColumnDef="sno">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
                                        <td mat-cell *matCellDef="let element" class="text-center">
                                          {{element.sno}} </td>
                                      </ng-container>
                                      <ng-container matColumnDef="accyear">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Fin Year </th>
                                        <td mat-cell *matCellDef="let element" class="text-center"> {{element.accyear}} </td>
                                      </ng-container>
                            
                                      <ng-container matColumnDef="turnoveramt">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Turn Over Amount( in RS) </th>
                                        <td mat-cell *matCellDef="let element" class="text-center"> {{element.turnoveramt}} </td>
                                      </ng-container>
                                      <ng-container matColumnDef="udinno">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>UDIN NO</th>
                                        <td mat-cell *matCellDef="let element" class="text-center"> {{element.udinno}} </td>
                                      </ng-container>
                                      <ng-container matColumnDef="filename">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>View Certificate</th>
                                        <td mat-cell *matCellDef="let element" class="text-center">
                                          <button
                                            class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle bg-danger-subtle"
                                            mat-button
                                            (click)="DownloadFileWithName(element.filepath,element.filename)"><i
                                              class="bi bi-filetype-pdf text-danger"></i>
                                          </button>
                                          
                                          <!-- (click)="openmarqModal('https://cgmsc.gov.in/cgmscl/Upload/Tender%20Document%20-243(R)202507000001.pdf')" -->
                                        </td>
                                      </ng-container>
                                      <ng-container matColumnDef="accyrsetid">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>accyrsetid </th>
                                        <td mat-cell *matCellDef="let element" class="text-center"> {{element.accyrsetid}} </td>
                                      </ng-container>
                            
                                      <ng-container matColumnDef="atid">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header> atid </th>
                                        <td mat-cell *matCellDef="let element" class="text-center"> {{element.atid}} </td>
                                      </ng-container>
                            
                                      <ng-container matColumnDef="action">
                                        <th mat-header-cell *matHeaderCellDef mat-sort-header>Edit</th>
                                        <td mat-cell *matCellDef="let element" class="text-center">
                                          <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                            <button
                                              class="btn btn-sm text-light align-items-center border rounded btn-outline-info-subtle  bg-info-subtle"
                                              mat-button (click)="onButtonClick(element.atid)">
                                              <i class="bi bi-pencil-square text-primary"></i>
                                            </button>
                                          <!-- </span> -->
                                        </td>
                                      </ng-container>
                                      <ng-container matColumnDef="delete">
                                        <th mat-header-cell *matHeaderCellDef>Delete</th>
                                        <td mat-cell *matCellDef="let element" class="text-center">
                                          <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                            <button
                                              class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle  bg-danger-subtle"
                                              mat-button (click)="onButtonClick(element.atid)">
                                              <i class="bi bi-trash text-danger"></i>
                                            </button>
                                          <!-- </span> -->
                                        </td>
                                      </ng-container>
                                      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                    </table>
                                    <mat-paginator #paginator [pageSizeOptions]="[5,10, 15, 30]" showFirstLastButtons></mat-paginator>
                                  </div>
                                </div>
                              </div>
                            </div>
                        </div>
                        <!-- END DATA TABLE -->
                        <div class="card shadow-lg p-4 border-0 bg-white rounded" *ngIf="onshowAT == true">
                          <div class="card-body border rounded px-0 pt-2 pb-3 bg-light"
                            style="height: auto; overflow: hidden; position: relative;">
                            <div class="mb-3 Fon-family" style="text-align: justify;">
                        
                              <form class="p-2" [formGroup]="AnnualTurnoverForm" (ngSubmit)="OnSubmmit()">
                                <div class="row pb-3">
                                  <div class="form-group col-md-6 pt-3">
                                    <label>Select Year <span class="text-danger">*</span></label>
                                    <!-- <ng-select
                                                                      class="form-control"
                                                                      [items]="Years"
                                                                      bindLabel="accyear"
                                                                      bindValue="accyrsetid"
                                                                      [placeholder]="'Select Existing Year'"
                                                                      formControlName="AccYrSetId"
                                                                      (change)="Onselectyear($event)"
                                                                      [searchable]="true"
                                                                      [clearable]="true"
                                                                      [appendTo]="'body'"
                                                                   
                                                                      [ngClass]="{
                                                                        'is-invalid': (AnnualTurnoverForm.get('AccYrSetId')?.touched || submitted) && AnnualTurnoverForm.get('AccYrSetId')?.invalid,
                                                                        'is-valid': AnnualTurnoverForm.get('AccYrSetId')?.valid && (AnnualTurnoverForm.get('AccYrSetId')?.touched || submitted)
                                                                      }">
                                                                    </ng-select> -->
                                    <select id="AccYrSetId" class="form-select" formControlName="AccYrSetId" (change)="Onselectyear($event)"
                                    [ngClass]="{
                                      'is-invalid': (AnnualTurnoverForm.get('AccYrSetId')?.touched || submitted) && AnnualTurnoverForm.get('AccYrSetId')?.invalid,
                                        'is-valid': AnnualTurnoverForm.get('AccYrSetId')?.valid && (AnnualTurnoverForm.get('AccYrSetId')?.touched || submitted)
                                        }">
                                      <option value="" disabled selected>Select Year</option>
                                      <option *ngFor="let year of Years" [value]="year.accyrsetid">
                                        {{ year.accyear }}
                                      </option>
                                    </select>
                                    <span class="text-danger"
                                      *ngIf="(AnnualTurnoverForm.get('AccYrSetId')?.touched || submitted) && AnnualTurnoverForm.get('AccYrSetId')?.errors?.['required']">
                                      Year selection is required.
                                    </span>
                                  </div>
                        
                                  <div class="form-group col-md-6 pt-3">
                                    <label>Turn Over Amount (Rs): <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" formControlName="TurnOverAmt" placeholder="Enter Turnover Amount"
                                      [ngClass]="{
                                                                        'is-invalid': (AnnualTurnoverForm.get('TurnOverAmt')?.touched || submitted) && AnnualTurnoverForm.get('TurnOverAmt')?.invalid,
                                                                        'is-valid': AnnualTurnoverForm.get('TurnOverAmt')?.valid && (AnnualTurnoverForm.get('TurnOverAmt')?.touched || submitted)
                                                                      }" />
                                    <span class="text-danger"
                                      *ngIf="(AnnualTurnoverForm.get('TurnOverAmt')?.touched || submitted) && AnnualTurnoverForm.get('TurnOverAmt')?.errors?.['required']">
                                      Turnover amount is required.
                                    </span>
                                  </div>
                                </div>
                        
                                <div class="row pb-3">
                                  <div class="form-group col-md-6 pt-3">
                                    <label>UDIN No: <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" formControlName="UDINNO" placeholder="Enter 18-digit UDIN No."
                                      maxlength="18" [ngClass]="{
                                                                        'is-invalid': (AnnualTurnoverForm.get('UDINNO')?.touched || submitted) && AnnualTurnoverForm.get('UDINNO')?.invalid,
                                                                        'is-valid': AnnualTurnoverForm.get('UDINNO')?.valid && (AnnualTurnoverForm.get('UDINNO')?.touched || submitted)
                                                                      }" />
                        
                                    <span class="text-danger" *ngIf="(AnnualTurnoverForm.get('UDINNO')?.touched || submitted)">
                        
                                      <!-- Required field -->
                                      <span *ngIf="AnnualTurnoverForm.get('UDINNO')?.errors?.['required']">
                                        UDIN No. is required
                                      </span>
                        
                                      <!-- Invalid pattern -->
                                      <span *ngIf="AnnualTurnoverForm.get('UDINNO')?.errors?.['pattern']">
                                        Enter a valid 18-character alphanumeric UDIN (Aâ€“Z, aâ€“z, 0â€“9 only)
                                      </span>
                                    </span>
                                  </div>
                                  <div class="form-group col-md-6 pt-3">
                                    <label>Upload Annual Turnover Certificate: <span class="text-danger">*</span></label>
                                    <input type="file" class="form-control" formControlName="TurnOverDocument" accept=".pdf"
                                      (change)="onFileSelectedanudocument($event)" [ngClass]="{
                                                                        'is-invalid': (AnnualTurnoverForm.get('TurnOverDocument')?.touched || submitted) && AnnualTurnoverForm.get('TurnOverDocument')?.invalid,
                                                                        'is-valid': AnnualTurnoverForm.get('TurnOverDocument')?.valid && (AnnualTurnoverForm.get('TurnOverDocument')?.touched || submitted)
                                                                      }" />
                                    <span class="text-danger"
                                      *ngIf="(AnnualTurnoverForm.get('TurnOverDocument')?.touched || submitted) && AnnualTurnoverForm.get('TurnOverDocument')?.errors?.['required']">
                                      Please upload the document.
                                    </span>
                                    <span class="text-danger" *ngIf="fileError">{{ fileError }}</span>
                        
                                  </div>
                                </div>
                        
                                <!-- <div class="row pb-3">
                                  <div class="form-group col-md-6 pt-3">
                                    <label>Upload Annual Turnover Certificate: <span class="text-danger">*</span></label>
                                    <input type="file" class="form-control" formControlName="TurnOverDocument" accept=".pdf"
                                      (change)="onFileSelectedanudocument($event)" [ngClass]="{
                                                                        'is-invalid': (AnnualTurnoverForm.get('TurnOverDocument')?.touched || submitted) && AnnualTurnoverForm.get('TurnOverDocument')?.invalid,
                                                                        'is-valid': AnnualTurnoverForm.get('TurnOverDocument')?.valid && (AnnualTurnoverForm.get('TurnOverDocument')?.touched || submitted)
                                                                      }" />
                                    <span class="text-danger"
                                      *ngIf="(AnnualTurnoverForm.get('TurnOverDocument')?.touched || submitted) && AnnualTurnoverForm.get('TurnOverDocument')?.errors?.['required']">
                                      Please upload the document.
                                    </span>
                                    <span class="text-danger" *ngIf="fileError">{{ fileError }}</span>
                        
                                  </div>
                                </div> -->
                        
                                <div class="d-flex justify-content-center mt-3">
                                  <button type="submit" class="btn btn-primary mt-3" [disabled]="!AnnualTurnoverForm.valid">Save</button>
                                 
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                    </div>
                  </ng-template>
                </div>
            </div>
        </ng-template>
      </mat-tab>

      <!-- GST CERTIFICATE Tab -->
      <mat-tab label="GST CERTIFICATE">
        <ng-template matTabContent>
          <div class="container-fluid p-0 m-0 ">
            <div class="row justify-content-center g-4 ">
              <div class="row g-4">
                <div class="container-fluid ">
                  <div class="row  p-2">
                    <div class="col-lg-12 mb-5">
                      <div *ngIf="loadingSectionC; else sectionAContentC" class="spinner-container">
                        <mat-spinner diameter="40"></mat-spinner>
                      </div>
                      <ng-template #sectionAContentC>
                      <div class="row justify-content-center g-4 p-3">
        
                        <!-- Card 1 -->
                        <div class="col-12 col-md-12 p-2">
                          <div class="" style="padding-bottom: 20px;">
                            <div class=" card row shadow ">
                              <div class="d-flex justify-content-between align-items-center m-2">
                                <div class="filter-field flex-grow-1">
                                  <input type="text" class="form-control" placeholder="Search"
                                    (keyup)="applyTextFilter($event)">
                                </div>
        
                                <div class="export-menu-container m-2">
                                  <button type="button" class="btn border rounded mr-1 text-light"
                                    style="background-color: rgb(21, 184, 0);" (click)="onButtonClickGST()">Add <i
                                      class="bi bi-folder-plus"></i></button>
                                  <!-- <button type="button" class="btn border rounded btn-outline-secondary" mat-button
                                    [matMenuTriggerFor]="exportMenu">Export</button>
                                  <mat-menu #exportMenu="matMenu">
                                    <button mat-menu-item
                                      (click)="exporter.exportTable('xlsx', { fileName: 'GSTD', sheet: 'GSTD', Props: { Author: 'cgmsc' }})">Excel</button>
                                    <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
                                    <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
                                     <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
                                    <button mat-menu-item (click)="exportToPDF()">PDF</button>
                                  </mat-menu> -->
                                </div>
                              </div>
        
                              <div class="table-responsive">
                                <table class="table table-bordered table-striped border rounded " mat-table matTableExporter
                                  [dataSource]="dataSource2" #exporter="matTableExporter" matSort #sort2="matSort">
        
                                  <ng-container matColumnDef="sno">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
                                    <td mat-cell *matCellDef="let element" class="text-center">
                                      {{element.sno}} </td>
                                  </ng-container>
                                  <ng-container matColumnDef="statename">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>State name </th>
                                    <td mat-cell *matCellDef="let element" class="text-center"> {{element.statename}} </td>
                                  </ng-container>
        
                                  <ng-container matColumnDef="gstno">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>GST NO</th>
                                    <td mat-cell *matCellDef="let element" class="text-center"> {{element.gstno}} </td>
                                  </ng-container>
                                  <ng-container matColumnDef="vregid">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>VREG ID</th>
                                    <td mat-cell *matCellDef="let element" class="text-center"> {{element.vregid}} </td>
                                  </ng-container>
                                  <ng-container matColumnDef="filename">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>View Certificate</th>
                                    <td mat-cell *matCellDef="let element" class="text-center">
                                      <button
                                        class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle bg-danger-subtle"
                                        mat-button
                                        (click)="DownloadFileWithName(element.filepath,element.filename)"
                                       ><i
                                          class="bi bi-filetype-pdf text-danger"></i>
                                          <!-- (click)="openmarqModal('https://cgmsc.gov.in/cgmscl/Upload/Tender%20Document%20-243(R)202507000001.pdf')" -->
                                      </button>
                                    </td>
                                  </ng-container>
        
                                  <ng-container matColumnDef="action">
                                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Edit</th>
                                    <td mat-cell *matCellDef="let element" class="text-center">
                                      <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                        <button
                                          class="btn btn-sm text-light align-items-center border rounded btn-outline-info-subtle  bg-info-subtle"
                                          mat-button (click)="onButtonClick(element.vregid)">
                                          <i class="bi bi-pencil-square text-primary"></i>
                                        </button>
                                      <!-- </span> -->
                                    </td>
                                  </ng-container>
                                  <ng-container matColumnDef="delete">
                                    <th mat-header-cell *matHeaderCellDef>Delete</th>
                                    <td mat-cell *matCellDef="let element" class="text-center">
                                      <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                        <button
                                          class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle  bg-danger-subtle"
                                          mat-button (click)="onButtonClick(element.atid)">
                                          <i class="bi bi-trash text-danger"></i>
                                        </button>
                                      <!-- </span> -->
                                    </td>
                                  </ng-container>
                                  <tr mat-header-row *matHeaderRowDef="displayedColumns2"></tr>
                                  <tr mat-row *matRowDef="let row; columns: displayedColumns2;"></tr>
                                </table>
                                <mat-paginator #paginator2 [pageSizeOptions]="[5,10, 15, 30]"
                                  showFirstLastButtons></mat-paginator>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="card shadow-lg p-4 border-0 bg-white rounded " *ngIf="onshowGST == true">
        
                        <div class="card-body border rounded px-0 pt-2 pb-3 bg-light"
                          style="height: auto; overflow: hidden; position: relative;">
                          <div class="mb-3 Fon-family" style="text-align: justify;">
                            <form class="p-2" #GSTForm="ngForm" (ngSubmit)="InsertGSTCertificate(GSTForm)">
                              <div class="row pb-3">
                                <div class="form-group col-md-6 pt-3" style="position: relative;">
                                  <label for="inputName">Select State <span class="text-danger">*</span></label>
                                  <ng-select class="form-control"  appendTo=".form-group" [items]="States" bindLabel="statename" bindValue="stateid" [(ngModel)]="statename"
                                    name="statename" (change)="OnselectStates($event)"
                                    [placeholder]="!statename ? 'Select State :' : ''"
                                    [searchable]="true"
                                    [clearable]="true" #stateid="ngModel"  required [ngStyle]="{
                                      'border': stateid.invalid && (stateid.dirty || stateid.touched) ? '1px solid #dc3545' :
                                      stateid.valid && (stateid.dirty || stateid.touched) ? '1px solid #198754' : '',
                                      'box-shadow': stateid.invalid && (stateid.dirty || stateid.touched) ? '0 0 0 0.1rem rgba(220,53,69,0.25)' :
                                      stateid.valid && (stateid.dirty || stateid.touched) ? '0 0 0 0.1rem rgba(25,135,84,0.25)' : ''
                                      }">
                                  
                                  </ng-select>
                                  <div class="text-danger mt-1"
                                    *ngIf="(stateid.touched || GSTForm.submitted) && stateid.errors?.['required']">
                                    Year selection is required.
                                  </div>
                                </div>
                                <div class="form-group col-md-6  pt-3">
                                  <label for="inputPassword4">GST No.: <span class="text-danger">*</span></label>
                                  <input type="text" class="form-control" id="turnoveran" name="gstno"
                                    placeholder="Type GST No." [(ngModel)]="gstno" #gstnoc="ngModel" minlength="15"
                                    maxlength="15" pattern="^[0-9A-Z]{15}$" required>
        
        
        
                                  <div *ngIf="gstnoc.invalid && (gstnoc.touched || GSTForm.submitted)"
                                    class="text-danger small">
                                    <div *ngIf="gstnoc.errors?.['required']">GST number is required</div>
                                    <div *ngIf="gstnoc.errors?.['minlength'] || gstnoc.errors?.['maxlength']">Must be 15
                                      characters</div>
                                    <div *ngIf="gstnoc.errors?.['pattern']">Invalid GST format (Use uppercase letters & numbers)
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <label for="inputnumber">Upload Document</label>
                              <div class="row pb-3">
                                <div class="form-group col-md-6 pt-3">
                                  <label for="inputnumber"> Upload GST Certificate: <span class="text-danger">*</span></label>
                                  <input type="file" class="form-control" id="filrs2" name="GSTCertificate" accept=".pdf"
                                    (change)="onFileSelectedanuGSTCertificate($event)" ngModel #GSTCertificateCtrl="ngModel"
                                    required
                                    [ngClass]="{
                                    'is-invalid': GSTCertificateCtrl.invalid && (GSTCertificateCtrl.touched || GSTForm.submitted),
                                    'is-valid': GSTCertificateCtrl.valid && (GSTCertificateCtrl.touched || GSTForm.submitted)
                                     }">
                                  <div *ngIf="GSTCertificateCtrl.invalid && (GSTCertificateCtrl.touched || GSTForm.submitted)">
                                    <small class="text-danger">Please upload the GST Certificate (PDF only).</small>
                                  </div>
                                </div>
                              </div>
                              <div class="d-flex justify-content-center mt-3">
                                <button type="submit" class="btn btn-primary mt-3" [disabled]="!GSTForm.valid">Save</button>
        
                              </div>
                              <!-- <button type="submit" class="btn btn-primary" >Submit</button> [disabled]="FeedbackForm.invalid"-->
                              <!-- <button type="submit" class="btn btn-primary">Submit</button> -->
                            </form>
                          </div>
                        </div>
                      </div>
                    </ng-template>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
        </mat-tab>

      <!-- GST RETURNS FOR 3D CERTIFICATE Tab -->
      <mat-tab label="GST RETURNS CERTIFICATE">
        <ng-template matTabContent>
            <div class="container-fluid p-0 m-0 ">
                <div class="row justify-content-center g-4 ">
                    <div class="row g-4">
                        <div class="container-fluid ">
                            <div class="row  p-2">
                                <div class="col-lg-12 mb-5">
                                  <div *ngIf="loadingSectionD; else sectionAContentD" class="spinner-container">
                                    <mat-spinner diameter="40"></mat-spinner>
                                  </div>
                                  <ng-template #sectionAContentD>
                                    <div class="row justify-content-center g-4 p-3">
    
                                        <!-- Card 1 -->
                                        <div class="col-12 col-md-12 p-2">
                                            <div class="" style="padding-bottom: 20px;">
                                                <div class=" card row shadow ">
                                                    <div class="d-flex justify-content-between align-items-center m-2">
                                                        <div class="filter-field flex-grow-1">
                                                            <input type="text" class="form-control" placeholder="Search"
                                                                (keyup)="applyTextFilter($event)">
                                                        </div>
                
                                                        <div class="export-menu-container m-2">
                                                          <button type="button" class="btn border rounded mr-1 text-light" 
                                                              style="background-color: rgb(21, 184, 0);" (click)="onButtonClickGSTR()">Add <i
                                                                  class="bi bi-folder-plus"></i></button>
                                                            <!-- <button type="button" class="btn border rounded btn-outline-secondary"
                                                                mat-button [matMenuTriggerFor]="exportMenu">Export</button>
                                                            <mat-menu #exportMenu="matMenu">
                                                                <button mat-menu-item
                                                                    (click)="exporter.exportTable('xlsx', { fileName: 'WorksOrderD', sheet: 'WorksOrderD', Props: { Author: 'cgmsc' }})">Excel</button>
                                                                <button mat-menu-item (click)="exporter.exportTable('csv')">CSV</button>
                                                                <button mat-menu-item (click)="exporter.exportTable('json')">JSON</button>
                                                                     <button mat-menu-item (click)="exporter.exportTable('txt')">TXT</button>
                                                                <button mat-menu-item (click)="exportToPDF()">PDF</button>
                                                            </mat-menu> -->
                                                        </div>
                                                    </div>
                                                    <div class="table-responsive">
                                                        <table class="table table-bordered table-striped border rounded " mat-table
                                                            matTableExporter [dataSource]="dataSource3" #exporter="matTableExporter"
                                                            matSort #sort3="matSort">
                
                                                            <ng-container matColumnDef="sno">
                                                                <th mat-header-cell *matHeaderCellDef mat-sort-header> S.No </th>
                                                                <td mat-cell *matCellDef="let element" class="text-center">
                                                                    {{element.sno}} </td>
                                                            </ng-container>
                                                            <ng-container matColumnDef="quartername" >
                                                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Month/Quarter Name </th>
                                                                <td mat-cell *matCellDef="let element" class="text-center"> {{element.quartername}} </td>
                                                              </ng-container>
                                                            <ng-container matColumnDef="gstno" >
                                                              <th mat-header-cell *matHeaderCellDef mat-sort-header>GST NO</th>
                                                              <td mat-cell *matCellDef="let element" class="text-center"> {{element.gstno}} </td>
                                                            </ng-container>
                                                            <ng-container matColumnDef="accyear" >
                                                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Financial Year</th>
                                                              <td mat-cell *matCellDef="let element" class="text-center"> {{element.accyear}} </td>
                                                            </ng-container>
                                                            <ng-container matColumnDef="startmonth" >
                                                              <th mat-header-cell *matHeaderCellDef mat-sort-header>Start Month</th>
                                                              <td mat-cell *matCellDef="let element" class="text-center"> {{element.startmonth}} </td>
                                                            </ng-container>
                                                            <ng-container matColumnDef="filename" >
                                                              <th mat-header-cell *matHeaderCellDef mat-sort-header>View Certificate</th>
                                                              <td mat-cell *matCellDef="let element" class="text-center">
                                                                <button
                                                                class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle bg-danger-subtle"
                                                                mat-button 
                                                                (click)="DownloadFileWithName(element.filepath,element.filename)"><i class="bi bi-filetype-pdf text-danger" ></i>
                                                            </button>
                                                            </td>
                                                            </ng-container>
                                                            <ng-container matColumnDef="endmonth" >
                                                              <th mat-header-cell *matHeaderCellDef mat-sort-header>End Month  </th>
                                                              <td mat-cell *matCellDef="let element" class="text-center"> {{element.endmonth}} </td>
                                                            </ng-container>
            
                                                            <ng-container matColumnDef="action">
                                                                <th mat-header-cell *matHeaderCellDef mat-sort-header>Edit</th>
                                                                <td mat-cell *matCellDef="let element" class="text-center">
                                                                    <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                                                        <button
                                                                            class="btn btn-sm text-light align-items-center border rounded btn-outline-info-subtle  bg-info-subtle"
                                                                            mat-button (click)="onButtonClick(element.vregid)"
                                                                           >
                                                                            <i class="bi bi-pencil-square text-primary"></i>
                                                                        </button>
                                                                    <!-- </span> -->
                                                                </td>
                                                            </ng-container>
                                                            <ng-container matColumnDef="delete">
                                                              <th mat-header-cell *matHeaderCellDef>Delete</th>
                                                              <td mat-cell *matCellDef="let element" class="text-center">
                                                                <!-- <span class="d-flex  flex-row-reverse p-2 "> -->
                                                                  <button
                                                                    class="btn btn-sm text-light align-items-center border rounded  btn-outline-danger-subtle  bg-danger-subtle"
                                                                    mat-button (click)="onButtonClick(element.atid)">
                                                                    <i class="bi bi-trash text-danger"></i>
                                                                  </button>
                                                                <!-- </span> -->
                                                              </td>
                                                            </ng-container>
                                                             <tr mat-header-row *matHeaderRowDef="displayedColumns3"></tr>
                                                            <tr mat-row *matRowDef="let row; columns: displayedColumns3;"></tr>
                                                        </table>
                                                        <mat-paginator #paginator3 [pageSizeOptions]="[5,10, 15, 30]"
                                                            showFirstLastButtons></mat-paginator>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card shadow-lg p-4 border-0 bg-white rounded "*ngIf="onshowGSTR == true">
                                        <div class="card-body border rounded px-0 pt-2 pb-3 bg-light"
                                            style="height: auto; overflow: hidden; position: relative;">
                                            <div class="mb-3 Fon-family" style="text-align: justify;">
                                                <form class="p-2" #GSTRETURNForm="ngForm" (ngSubmit)="InsertMASGSTRETURNFILES(GSTRETURNForm)">
                                                    <div class="row pb-3">
                                                      <!-- GST NO -->
                                                      <div class="form-group col-md-6 pt-3" style="position: relative;">
                                                        <label>Select GST No<span class="text-danger">*</span></label>
                                                        <ng-select class="form-control"
                                                          [items]="dispatchData2"
                                                          bindLabel="gstno"
                                                          bindValue="gstid"
                                                          [(ngModel)]="gstno"
                                                          name="gstno"
                                                          (change)="Onselectgstno($event)"
                                                          [placeholder]="!gstno ? 'GST NO is selected :' : ''"
                                                        
                                                          [searchable]="true"
                                                          [clearable]="true" #gstid="ngModel"  appendTo=".form-group"  required [ngStyle]="{
                                                            'border': gstid.invalid && (gstid.dirty || gstid.touched) ? '1px solid #dc3545' :
                                                            gstid.valid && (gstid.dirty || gstid.touched) ? '1px solid #198754' : '',
                                                            'box-shadow': gstid.invalid && (gstid.dirty || gstid.touched) ? '0 0 0 0.1rem rgba(220,53,69,0.25)' :
                                                            gstid.valid && (gstid.dirty || gstid.touched) ? '0 0 0 0.1rem rgba(25,135,84,0.25)' : ''
                                                            }">
                                                        </ng-select>
                                                        <div class="text-danger mt-1"
                                                        *ngIf="(gstid.touched || GSTRETURNForm.submitted) && gstid.errors?.['required']">
                                                        GST No is required.
                                                      </div>
                                                      </div>
                                                  
                                                      <!-- Month / Quarter -->
                                                      <div class="form-group col-md-6 pt-3" style="position: relative;">
                                                        <label>Select Month: <span class="text-danger">*</span></label>
                                                        <ng-select class="form-control" [items]="MASGSTQUARTER"
                                                        bindLabel="quartername" bindValue="gstqtrid" [(ngModel)]="quartername"
                                                        name="quartername" (change)="OnselectMASGSTQUARTER($event)"
                                                        [placeholder]="!quartername ? 'Show Months :' : ''" 
                                                         [searchable]="true"
                                                        [clearable]="true"  appendTo=".form-group" #gstqtrid="ngModel"   required [ngStyle]="{
                                                          'border': gstqtrid.invalid && (gstqtrid.dirty || gstqtrid.touched) ? '1px solid #dc3545' :
                                                          gstqtrid.valid && (gstqtrid.dirty || gstqtrid.touched) ? '1px solid #198754' : '',
                                                          'box-shadow': gstqtrid.invalid && (gstqtrid.dirty || gstqtrid.touched) ? '0 0 0 0.1rem rgba(220,53,69,0.25)' :
                                                          gstqtrid.valid && (gstqtrid.dirty || gstqtrid.touched) ? '0 0 0 0.1rem rgba(25,135,84,0.25)' : ''
                                                          }">
                                                      </ng-select>
                                                      <div class="text-danger mt-1"
                                                      *ngIf="(gstqtrid.touched || GSTRETURNForm.submitted) && gstqtrid.errors?.['required']">
                                                      Month / Quarter is required.
                                                    </div>
                                                      </div>
                                                    </div>
                                                  
                                                    <!-- Financial Year -->
                                                    <div class="row pb-3">
                                                      <div class="form-group col-md-6 pt-3" style="position: relative;">
                                                        <label>Select Financial Year <span class="text-danger">*</span></label>
                                                        <ng-select class="form-control" [items]="AccYearSettings"
                                                        bindLabel="accyear" bindValue="accyrsetid" [(ngModel)]="accyear"
                                                        name="accyear" (change)="OnselectAccYearSettings($event)"
                                                        [placeholder]="!accyear ? 'year is selected:' : ''"  [searchable]="true"
                                                        [clearable]="true"  #accyrsetid="ngModel"  appendTo=".form-group"  required [ngStyle]="{
                                                          'border': accyrsetid.invalid && (accyrsetid.dirty || accyrsetid.touched) ? '1px solid #dc3545' :
                                                          accyrsetid.valid && (accyrsetid.dirty || accyrsetid.touched) ? '1px solid #198754' : '',
                                                          'box-shadow': accyrsetid.invalid && (accyrsetid.dirty || accyrsetid.touched) ? '0 0 0 0.1rem rgba(220,53,69,0.25)' :
                                                          accyrsetid.valid && (accyrsetid.dirty || accyrsetid.touched) ? '0 0 0 0.1rem rgba(25,135,84,0.25)' : ''
                                                          }">
                                                      </ng-select>
                                                      <div class="text-danger mt-1"
                                                      *ngIf="(accyrsetid.touched || GSTRETURNForm.submitted) && accyrsetid.errors?.['required']">
                                                      Financial Year is required.
                                                    </div>
                                                      </div>
                                                    </div>
                                                  
                                                    <!-- File Upload -->
                                                    <label>Upload Document</label>
                                                    <div class="row pb-3">
                                                        <div class="form-group col-md-6 pt-3">
                                                            <label for="inputnumber"> Upload GST returns of at least 1 month of last 3 month: <span
                                                                    class="text-danger">*</span></label>
                                                            <input type="file" class="form-control" 
                                                                placeholder="Type your PDF file" id="inputnumber" name="GSTreturnCertificate"
                                                                accept=".pdf"
                                                                (change)="onFileSelectedGSTReturn($event)"
                                                                required
                                                                ngModel #GSTreturnCertificate="ngModel"
                                                                [ngClass]="{
                                                                'is-invalid': GSTreturnCertificate.invalid && (GSTreturnCertificate.touched || GSTRETURNForm.submitted),
                                                                'is-valid': GSTreturnCertificate.valid && (GSTreturnCertificate.touched || GSTRETURNForm.submitted)
                                                                 }">
                                                                  <div *ngIf="GSTreturnCertificate.invalid && (GSTreturnCertificate.touched || GSTRETURNForm.submitted)">
                                                                    <small class="text-danger">Please upload the GST returns Certificate (PDF only).</small>
                                                                  </div>
                                                        </div>
                                                        <!-- <div class="form-group col-md-6 pt-3">
                                                            <button type="button" class="btn btn-primary m-3">Upload</button>
                                                            <button type="submit" class="btn btn-primary m-3">Download Bank
                                                                Mandate</button>
                                                        </div> -->
                                                    </div>
                                                      <div class="d-flex justify-content-center mt-3">
                                                        <button type="submit" class="btn btn-primary mt-3" [disabled]="!GSTRETURNForm.valid">Save</button>
                                              
                                                      </div>
                                                  </form>
                                            </div>
                                        </div>
                                    </div>
                                  </ng-template>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
 </div>








<!-- Modal -->
  <div class="modal fade custom-transparent-modal" id="pdfModal" tabindex="-1" aria-labelledby="pdfModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-fullscreen">
      <div class="modal-content border-0 shadow-none">
        <div class="modal-header bg-dark text-white py-2 px-3">
          <h5 class="modal-title" id="pdfModalLabel">PDF Preview</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body p-0">
          <iframe
            [src]="sanitizedPdfUrl"
            class="pdf-frame"
            allowfullscreen
          ></iframe>
        </div>
      </div>
    </div>
  </div>
  
  